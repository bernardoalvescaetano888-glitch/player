<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Player Supremo Visual</title>
<style>
:root{--accent:#ff6600;--fg:#eee;}
body{margin:0;font-family:Arial,Helvetica,sans-serif;display:flex;height:100vh;color:var(--fg);background:linear-gradient(270deg,#ff6600,#ffcc00,#00ccff,#6600ff);background-size: 800% 800%;animation: gradientAnimation 30s ease infinite;overflow:hidden;}
@keyframes gradientAnimation{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
#sidebar{width:260px;padding:18px;border-right:1px solid rgba(255,255,255,0.2);box-sizing:border-box;background:rgba(0,0,0,0.5);backdrop-filter: blur(6px);overflow:auto;}
#main{flex:1;padding:18px;box-sizing:border-box;overflow:auto;}
h1,h3{margin:0 0 12px 0;color:var(--accent);}
button{cursor:pointer;padding:8px 12px;border-radius:6px;border:0;background:rgba(0,0,0,0.5);color:#fff;margin:2px;transition:0.3s;}
button:hover{background:rgba(0,0,0,0.8);transform:scale(1.05);}
input[type="file"],input[type="text"],input[type="range"],select{display:block;margin:8px 0;padding:6px;width:100%;box-sizing:border-box;border-radius:6px;border:1px solid rgba(255,255,255,0.3);background:rgba(0,0,0,0.3);color:#fff;}
ul{padding-left:0;list-style:none;margin:8px 0;max-height:220px;overflow:auto;}
li{padding:6px;border-radius:6px;margin:4px 0;background:rgba(0,0,0,0.5);display:flex;justify-content:space-between;align-items:center;transition:0.3s;cursor:pointer;}
li.active{background:var(--accent);color:#111;font-weight:bold;box-shadow:0 0 10px var(--accent);}
li:hover{background:rgba(255,255,255,0.1);transform:scale(1.02);}
#cover{width:260px;height:260px;object-fit:cover;border-radius:8px;background:#222;margin-bottom:10px;transition:transform 0.5s;}
#cover.rotate{animation:rotateCover 10s linear infinite;}
@keyframes rotateCover{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
canvas{border-radius:6px;margin-top:8px;background:rgba(0,0,0,0.2);}
#progress{-webkit-appearance:none;width:100%;height:12px;border-radius:6px;background:linear-gradient(90deg,#ff6600,#ffcc00,#00ccff);background-size:300% 100%;animation: progressGradient 5s linear infinite;outline:none;cursor:pointer;}
#progress::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:#fff;border:2px solid var(--accent);cursor:pointer;transition:transform 0.2s;}
#progress::-webkit-slider-thumb:hover{transform:scale(1.2);}
@keyframes progressGradient{0%{background-position:0% 0%;}50%{background-position:100% 0%;}100%{background-position:0% 0%;}}
.small{font-size:13px;color:#bbb;}
</style>
</head>
<body>
<div id="sidebar">
  <div id="clock" class="small">Hora: --:--</div>
  <h3 class="accent">Controles</h3>
  <button onclick="toggleLoop()">Loop: <span id="loopLabel">Off</span></button>
  <button onclick="toggleShuffle()">Shuffle: <span id="shuffleLabel">Off</span></button>
  <hr>
  <h3 class="accent">Favoritos</h3>
  <ul id="favoritesList"></ul>
  <h3 class="accent">Hist√≥rico</h3>
  <ul id="historyList"></ul>
</div>

<div id="main">
  <h1>üéß Player Supremo Visual</h1>
  <input id="searchMusic" placeholder="Pesquisar m√∫sicas...">
  <img id="cover" src="" alt="Capa">
  <audio id="player" controls style="width:100%;display:block"></audio>
  <div id="controls">
    <button onclick="prevMusic()">‚óÄ</button>
    <button onclick="playPause()">‚èØ</button>
    <button onclick="nextMusic()">‚ñ∂</button>
    <button id="favBtn" onclick="toggleFavorite()">‚ô°</button>
  </div>
  <label>Volume: <input id="volume" type="range" min="0" max="1" step="0.01" value="1"></label>
  <canvas id="visualizer" height="150"></canvas>
  <h3 class="accent">Progresso</h3>
  <input type="range" id="progress" min="0" max="100" value="0">
  <div class="small" id="timeDisplay">00:00 / 00:00</div>
  <h3 class="accent">Lista de m√∫sicas</h3>
  <input type="file" id="filePicker" multiple accept="audio/*">
  <ul id="musicList"></ul>
</div>

<script>
let musicList=[], currentIndex=0, loop=false, shuffle=false;
let favorites=JSON.parse(localStorage.getItem("favorites")||"[]");
let history=JSON.parse(localStorage.getItem("history")||"[]");
const player=document.getElementById("player");
const cover=document.getElementById("cover");
const progress=document.getElementById("progress");
const timeDisplay=document.getElementById("timeDisplay");
const canvas=document.getElementById("visualizer");
const ctx=canvas.getContext("2d");

// Clock
function updateClock(){const d=new Date();document.getElementById("clock").textContent=`Hora: ${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')}`;}
setInterval(updateClock,1000);updateClock();

// M√∫sica
function addMusic(f){const url=URL.createObjectURL(f);musicList.push({name:f.name,url});renderList();}
function renderList(){const ul=document.getElementById("musicList");const s=document.getElementById("searchMusic").value.toLowerCase();ul.innerHTML="";musicList.forEach((m,i)=>{if(m.name.toLowerCase().includes(s)){const li=document.createElement("li");li.textContent=m.name;li.onclick=()=>playIndex(i);ul.appendChild(li);}});}
function playIndex(i){
  if(i<0||i>=musicList.length)return;
  currentIndex=i;
  player.src=musicList[i].url;
  player.play().then(()=>initAudio()).catch(()=>console.log("Clique para desbloquear o √°udio"));
  cover.classList.add("rotate");
}
function playPause(){if(player.paused)player.play().then(()=>initAudio());else player.pause();}
function nextMusic(){if(shuffle) currentIndex=Math.floor(Math.random()*musicList.length); else currentIndex++; if(currentIndex>=musicList.length) currentIndex=0; playIndex(currentIndex);}
function prevMusic(){currentIndex--; if(currentIndex<0) currentIndex=musicList.length-1; playIndex(currentIndex);}
function toggleLoop(){loop=!loop;document.getElementById("loopLabel").textContent=loop?"On":"Off";}
function toggleShuffle(){shuffle=!shuffle;document.getElementById("shuffleLabel").textContent=shuffle?"On":"Off";}

// Volume
document.getElementById("volume").addEventListener("input",()=>{player.volume=document.getElementById("volume").value;});
// Progresso
player.addEventListener("timeupdate",()=>{if(player.duration){progress.value=(player.currentTime/player.duration)*100;const c=Math.floor(player.currentTime),d=Math.floor(player.duration);timeDisplay.textContent=`${Math.floor(c/60).toString().padStart(2,'0')}:${(c%60).toString().padStart(2,'0')} / ${Math.floor(d/60).toString().padStart(2,'0')}:${(d%60).toString().padStart(2,'0')}`;}});
progress.addEventListener("input",()=>{player.currentTime=(progress.value/100)*player.duration;});

// File picker
document.getElementById("filePicker").addEventListener("change",e=>{Array.from(e.target.files).forEach(f=>addMusic(f));});
document.getElementById("searchMusic").addEventListener("input",renderList);

// Favoritos
function toggleFavorite(){const c=musicList[currentIndex];const idx=favorites.findIndex(f=>f.url===c.url);if(idx>=0)favorites.splice(idx,1);else favorites.push(c);localStorage.setItem("favorites",JSON.stringify(favorites));renderFavorites();}
function renderFavorites(){const ul=document.getElementById("favoritesList");ul.innerHTML="";favorites.forEach(f=>{const li=document.createElement("li");li.textContent=f.name;ul.appendChild(li);});}

// Hist√≥rico
function addToHistory(song){history.push(song);localStorage.setItem("history",JSON.stringify(history));renderHistory();}
function renderHistory(){const ul=document.getElementById("historyList");ul.innerHTML="";history.forEach(h=>{const li=document.createElement("li");li.textContent=h.name;ul.appendChild(li);});}

// Visualizador
let audioCtx, analyser, source;
function initAudio(){
  if(audioCtx) return;
  audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  source=audioCtx.createMediaElementSource(player);
  analyser=audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  analyser.fftSize=256;
  drawVisualizer();
}
function drawVisualizer(){
  requestAnimationFrame(drawVisualizer);
  if(!analyser) return;
  const bufferLength=analyser.frequencyBinCount;
  const dataArray=new Uint8Array(bufferLength);
  analyser.getByteFrequencyData(dataArray);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const barWidth=canvas.width/bufferLength;
  for(let i=0;i<bufferLength;i++){
    const barHeight=dataArray[i];
    const gradient=ctx.createLinearGradient(0,canvas.height-barHeight,0,canvas.height);
    gradient.addColorStop(0,"#ff6600");
    gradient.addColorStop(0.5,"#ffcc00");
    gradient.addColorStop(1,"#00ccff");
    ctx.fillStyle=gradient;
    ctx.fillRect(i*barWidth,canvas.height-barHeight,barWidth,barHeight);
  }
}
</script>
</body>
</html>
